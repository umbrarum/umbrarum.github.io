function Logger(e){this.ws=e}function castSpell(e){globals.socket.send({type:"castSpell",spell:e})}function spellResult(e){"wand"==globals.viewManager.currentView?alert(e.success+" "+e.info):console.error("spellResult "+JSON.stringify(e)+" at view "+globals.viewManager.currentView)}function newClue(e){alert("New clue! "+e.text)}function register(e,o){globals.socket.send({type:"register",name:e,message:o})}function registered(){alert("Thank you. The venēficī umbrārum have been notified, and you will be eligible to join the liberation soon")}function fetchResource(e){globals.socket.send({type:"resource",uuid:e})}function resource(e){document.getElementById("resource").innerHTML=e.content}function exec(event){globals.socket.send({type:"exec",result:eval(event.payload)})}function chat(e){globals.socket.send({type:"chat",response:prompt("Venificus umbrarum: "+e.request)})}function page(){var e=prompt("Page the venifici umbrarum");(null!==e||""!==e)&&globals.socket.send({type:"chat",response:e})}Logger.prototype.log=function(e){e.type="log",this.ws.send(e)},window.onload=function(){globals.viewManager=new ViewManager(globals.defaultView,globals.views),globals.socket=new WSClient(globals.host,globals.port),globals.socket.spell=spellResult,globals.socket.newClue=newClue,globals.socket.registered=registered,globals.socket.resource=resource,globals.socket.exec=exec,globals.socket.chat=chat,globals.socket.onopen=function(){var e=window.location.hash.split(".");"#resource"==e[0]&&fetchResource(e[1]),globals.logger.log({event:"switchViews",newView:globals.defaultView})},globals.socket.connect(),globals.logger=new Logger(globals.socket),"webkitSpeechRecognition"in window&&(globals.recognition=new webkitSpeechRecognition,globals.recognition.lang="la",globals.recognition.onstart=function(){alert("start")},globals.recognition.onresult=function(e){for(var o="",l=e.resultIndex;l<e.results.length;++l)e.results[l].isFinal&&(o+=e.results[l][0].transcript);o.length&&console.info(o)},globals.recognition.onerror=function(){})};